// Generate comprehensive 2023 cash flow test data - different structure
const XLSX = require('xlsx');

function generateCashflow2023() {
  const quarters = ['Q1 2023', 'Q2 2023', 'Q3 2023', 'Q4 2023'];
  const months = [
    'January', 'February', 'March', 'April', 'May', 'June',
    'July', 'August', 'September', 'October', 'November', 'December'
  ];

  // Different structure - quarterly summary with monthly detail
  const data = [
    ['GLOBAL DYNAMICS CORP', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['COMPREHENSIVE CASH FLOW ANALYSIS - 2023', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Generated on: ' + new Date().toISOString().split('T')[0], '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    // QUARTERLY OVERVIEW
    ['QUARTERLY SUMMARY', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Period', 'Q1 2023', 'Q2 2023', 'Q3 2023', 'Q4 2023', 'ANNUAL TOTAL', '', '', '', '', '', '', '', '', '', ''],
    ['Revenue Streams:', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['- Enterprise Software', 2850000, 3100000, 3350000, 3800000, 13100000, '', '', '', '', '', '', '', '', '', ''],
    ['- Cloud Services', 1920000, 2150000, 2380000, 2650000, 9100000, '', '', '', '', '', '', '', '', '', ''],
    ['- Professional Services', 850000, 920000, 1050000, 1180000, 4000000, '', '', '', '', '', '', '', '', '', ''],
    ['- Support & Maintenance', 1650000, 1750000, 1850000, 1950000, 7200000, '', '', '', '', '', '', '', '', '', ''],
    ['Total Revenue', 7270000, 7920000, 8630000, 9580000, 33400000, '', '', '', '', '', '', '', '', '', ''],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    ['Operating Expenses:', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['- Personnel Costs', -2180000, -2350000, -2520000, -2720000, -9770000, '', '', '', '', '', '', '', '', '', ''],
    ['- Infrastructure', -580000, -620000, -660000, -720000, -2580000, '', '', '', '', '', '', '', '', '', ''],
    ['- Sales & Marketing', -920000, -1050000, -1180000, -1350000, -4500000, '', '', '', '', '', '', '', '', '', ''],
    ['- R&D Investment', -1450000, -1580000, -1720000, -1920000, -6670000, '', '', '', '', '', '', '', '', '', ''],
    ['- General & Admin', -420000, -450000, -480000, -520000, -1870000, '', '', '', '', '', '', '', '', '', ''],
    ['Total Operating Expenses', -5550000, -6050000, -6560000, -7230000, -25390000, '', '', '', '', '', '', '', '', '', ''],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    ['Net Operating Cash Flow', 1720000, 1870000, 2070000, 2350000, 8010000, '', '', '', '', '', '', '', '', '', ''],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    // MONTHLY BREAKDOWN
    ['MONTHLY DETAILED BREAKDOWN', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Month', ...months, '', '', ''],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    // INFLOWS
    ['CASH INFLOWS', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Enterprise Software Sales', 920000, 980000, 950000, 1050000, 1080000, 970000, 1120000, 1150000, 1080000, 1280000, 1320000, 1200000, '', '', ''],
    ['Cloud Subscription Revenue', 580000, 620000, 720000, 680000, 750000, 720000, 780000, 820000, 780000, 850000, 900000, 900000, '', '', ''],
    ['Consulting Services', 250000, 280000, 320000, 290000, 320000, 310000, 340000, 370000, 340000, 380000, 420000, 380000, '', '', ''],
    ['Training & Certification', 180000, 195000, 220000, 200000, 215000, 230000, 245000, 260000, 240000, 270000, 285000, 280000, '', '', ''],
    ['Maintenance Contracts', 520000, 545000, 585000, 575000, 585000, 590000, 610000, 620000, 620000, 640000, 655000, 655000, '', '', ''],
    ['License Renewals', 380000, 420000, 450000, 480000, 520000, 540000, 580000, 620000, 650000, 720000, 780000, 820000, '', '', ''],
    ['Partnership Revenue', 120000, 135000, 150000, 165000, 180000, 195000, 210000, 225000, 240000, 260000, 280000, 300000, '', '', ''],
    ['Government Contracts', 0, 0, 850000, 0, 0, 1200000, 0, 0, 950000, 0, 0, 1450000, '', '', ''],
    ['International Sales', 180000, 195000, 210000, 230000, 250000, 270000, 290000, 310000, 330000, 350000, 380000, 420000, '', '', ''],
    ['Total Monthly Inflows', 3130000, 3370000, 4455000, 3670000, 3900000, 5025000, 4175000, 4375000, 4230000, 4750000, 5020000, 5405000, '', '', ''],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    // OUTFLOWS  
    ['CASH OUTFLOWS', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Salaries & Wages', -680000, -695000, -710000, -720000, -735000, -750000, -765000, -780000, -795000, -810000, -825000, -840000, '', '', ''],
    ['Benefits & Insurance', -180000, -185000, -190000, -195000, -200000, -205000, -210000, -215000, -220000, -225000, -230000, -235000, '', '', ''],
    ['Bonuses & Commissions', -120000, -85000, -95000, -180000, -145000, -160000, -195000, -175000, -185000, -280000, -320000, -450000, '', '', ''],
    ['Office Rent & Utilities', -85000, -87000, -89000, -91000, -93000, -95000, -97000, -99000, -101000, -103000, -105000, -107000, '', '', ''],
    ['Technology Infrastructure', -125000, -135000, -145000, -155000, -165000, -175000, -185000, -195000, -205000, -215000, -225000, -235000, '', '', ''],
    ['Cloud & Software Licenses', -95000, -98000, -102000, -105000, -108000, -112000, -115000, -118000, -122000, -125000, -128000, -132000, '', '', ''],
    ['Marketing Campaigns', -180000, -220000, -280000, -250000, -320000, -380000, -290000, -350000, -420000, -380000, -450000, -520000, '', '', ''],
    ['Sales Travel & Events', -45000, -52000, -68000, -75000, -85000, -92000, -88000, -95000, -105000, -115000, -125000, -140000, '', '', ''],
    ['Professional Services', -75000, -80000, -85000, -90000, -95000, -100000, -105000, -110000, -115000, -120000, -125000, -130000, '', '', ''],
    ['R&D Equipment', -180000, -220000, -280000, -320000, -350000, -280000, -420000, -480000, -520000, -580000, -620000, -720000, '', '', ''],
    ['Contractors & Freelancers', -95000, -105000, -125000, -135000, -145000, -155000, -165000, -175000, -185000, -195000, -205000, -215000, '', '', ''],
    ['Legal & Compliance', -25000, -28000, -32000, -35000, -38000, -42000, -45000, -48000, -52000, -55000, -58000, -62000, '', '', ''],
    ['Training & Development', -35000, -40000, -45000, -50000, -55000, -60000, -65000, -70000, -75000, -80000, -85000, -90000, '', '', ''],
    ['Office Supplies & Equipment', -28000, -32000, -38000, -42000, -48000, -52000, -58000, -62000, -68000, -72000, -78000, -82000, '', '', ''],
    ['Insurance & Risk Management', -22000, -22000, -25000, -25000, -28000, -28000, -30000, -30000, -32000, -32000, -35000, -35000, '', '', ''],
    ['Total Monthly Outflows', -1970000, -2084000, -2309000, -2468000, -2610000, -2686000, -2858000, -3002000, -3300000, -3387000, -3614000, -4013000, '', '', ''],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    // NET CASH FLOW
    ['NET CASH FLOW', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Monthly Net Cash Flow', 1160000, 1286000, 2146000, 1202000, 1290000, 2339000, 1317000, 1373000, 930000, 1363000, 1406000, 1392000, '', '', ''],
    ['Cumulative Cash Flow', 1160000, 2446000, 4592000, 5794000, 7084000, 9423000, 10740000, 12113000, 13043000, 14406000, 15812000, 17204000, '', '', ''],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    // CASH POSITION
    ['CASH POSITION TRACKING', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Opening Balance', 2850000, 4010000, 5296000, 7442000, 8644000, 9934000, 12273000, 13590000, 14963000, 15893000, 17256000, 18662000, '', '', ''],
    ['Cash Receipts', 3130000, 3370000, 4455000, 3670000, 3900000, 5025000, 4175000, 4375000, 4230000, 4750000, 5020000, 5405000, '', '', ''],
    ['Cash Payments', -1970000, -2084000, -2309000, -2468000, -2610000, -2686000, -2858000, -3002000, -3300000, -3387000, -3614000, -4013000, '', '', ''],
    ['Closing Balance', 4010000, 5296000, 7442000, 8644000, 9934000, 12273000, 13590000, 14963000, 15893000, 17256000, 18662000, 20054000, '', '', ''],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    // INVESTMENT ACTIVITIES
    ['INVESTMENT ACTIVITIES', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Capital Expenditures', -250000, 0, -180000, -320000, 0, -450000, -280000, 0, -380000, -520000, 0, -680000, '', '', ''],
    ['Technology Upgrades', -85000, -95000, -105000, -115000, -125000, -135000, -145000, -155000, -165000, -175000, -185000, -195000, '', '', ''],
    ['Acquisitions', 0, 0, -2500000, 0, 0, 0, 0, 0, -1800000, 0, 0, -3200000, '', '', ''],
    ['Real Estate Investment', 0, -850000, 0, 0, -1200000, 0, 0, -950000, 0, 0, -1500000, 0, '', '', ''],
    ['Equipment Financing', 0, 0, 0, 180000, 0, 0, 0, 150000, 0, 0, 0, 220000, '', '', ''],
    ['Total Investment Flow', -335000, -945000, -2785000, -255000, -1325000, -585000, -425000, -955000, -2345000, -695000, -1685000, -3855000, '', '', ''],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    // FINANCING ACTIVITIES
    ['FINANCING ACTIVITIES', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Term Loan Drawdown', 0, 0, 2000000, 0, 0, 0, 0, 0, 1500000, 0, 0, 0, '', '', ''],
    ['Credit Line Usage', 500000, -200000, 300000, -400000, 600000, -350000, 450000, -280000, 380000, -420000, 550000, -380000, '', '', ''],
    ['Loan Principal Payments', -85000, -85000, -85000, -90000, -90000, -90000, -95000, -95000, -95000, -100000, -100000, -100000, '', '', ''],
    ['Interest Payments', -35000, -38000, -42000, -45000, -48000, -52000, -55000, -58000, -62000, -65000, -68000, -72000, '', '', ''],
    ['Dividend Distributions', 0, 0, -500000, 0, 0, -750000, 0, 0, -650000, 0, 0, -850000, '', '', ''],
    ['Share Issuance', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1500000, '', '', ''],
    ['Owner Contributions', 200000, 0, 0, 0, 300000, 0, 0, 0, 0, 0, 400000, 0, '', '', ''],
    ['Total Financing Flow', 580000, -323000, 1673000, -535000, 762000, -1242000, 300000, -433000, 1073000, -585000, 782000, 98000, '', '', ''],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    // FINAL CASH RECONCILIATION
    ['FINAL CASH POSITION', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Beginning Cash', 2850000, 4255000, 4213000, 5644000, 6856000, 8055000, 9496000, 10681000, 11606000, 11374000, 12559000, 14258000, '', '', ''],
    ['Operating Cash Flow', 1160000, 1286000, 2146000, 1202000, 1290000, 2339000, 1317000, 1373000, 930000, 1363000, 1406000, 1392000, '', '', ''],
    ['Investment Cash Flow', -335000, -945000, -2785000, -255000, -1325000, -585000, -425000, -955000, -2345000, -695000, -1685000, -3855000, '', '', ''],
    ['Financing Cash Flow', 580000, -323000, 1673000, -535000, 762000, -1242000, 300000, -433000, 1073000, -585000, 782000, 98000, '', '', ''],
    ['Ending Cash', 4255000, 4273000, 5247000, 6056000, 7583000, 8567000, 10688000, 11666000, 11264000, 12457000, 13062000, 11893000, '', '', ''],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    // ADVANCED METRICS
    ['ADVANCED ANALYTICS', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Free Cash Flow', 825000, 341000, -639000, 947000, -35000, 1754000, 892000, 418000, -1415000, 668000, -279000, -2463000, '', '', ''],
    ['Operating Margin %', 37.1, 38.2, 48.2, 32.7, 33.1, 46.5, 31.5, 31.4, 22.0, 28.7, 28.0, 25.8, '', '', ''],
    ['Cash Conversion Days', 45, 42, 38, 41, 39, 35, 37, 38, 41, 39, 36, 34, '', '', ''],
    ['Burn Rate (Monthly)', 1970000, 2084000, 2309000, 2468000, 2610000, 2686000, 2858000, 3002000, 3300000, 3387000, 3614000, 4013000, '', '', ''],
    ['Runway (Months)', 2.16, 2.05, 2.27, 2.45, 2.90, 3.19, 3.74, 3.88, 3.41, 3.68, 3.61, 2.96, '', '', ''],
    ['Working Capital', 890000, 945000, 1120000, 1180000, 1285000, 1420000, 1520000, 1635000, 1580000, 1720000, 1850000, 1920000, '', '', '']
  ];

  // Create workbook
  const wb = XLSX.utils.book_new();
  const ws = XLSX.utils.aoa_to_sheet(data);
  
  // Set column widths
  ws['!cols'] = [
    {wch: 35}, // Column A (descriptions)
    {wch: 12}, {wch: 12}, {wch: 12}, {wch: 12}, // Months 1-4
    {wch: 12}, {wch: 12}, {wch: 12}, {wch: 12}, // Months 5-8
    {wch: 12}, {wch: 12}, {wch: 12}, {wch: 12}, // Months 9-12
    {wch: 15}, {wch: 15}, {wch: 15} // Extra columns
  ];
  
  XLSX.utils.book_append_sheet(wb, ws, "Global Dynamics 2023");
  
  // Write file
  XLSX.writeFile(wb, 'Cashflow_2023_GlobalDynamics.xlsx');
  console.log('Generated Cashflow_2023_GlobalDynamics.xlsx');
}

generateCashflow2023();