// Generate comprehensive 2024 cash flow test data - modern SaaS structure
const XLSX = require('xlsx');

function generateCashflow2024() {
  const periods = [
    'Jan-24', 'Feb-24', 'Mar-24', 'Apr-24', 'May-24', 'Jun-24',
    'Jul-24', 'Aug-24', 'Sep-24', 'Oct-24', 'Nov-24', 'Dec-24'
  ];

  // Modern SaaS company structure with different metrics
  const data = [
    ['CLOUDTECH INNOVATIONS LTD', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['STATEMENT OF CASH FLOWS - 2024', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['All figures in USD', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Report Generated: ' + new Date().toLocaleDateString(), '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    // REVENUE BREAKDOWN
    ['REVENUE ANALYSIS', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Period â†’', ...periods, 'YTD TOTAL', 'FORECAST'],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    // SaaS Revenue Streams
    ['SUBSCRIPTION REVENUE', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Monthly Recurring Revenue (MRR)', 1850000, 1920000, 2010000, 2080000, 2160000, 2250000, 2340000, 2420000, 2510000, 2600000, 2680000, 2770000, 28590000, 3100000],
    ['Annual Subscriptions (ARR)', 450000, 520000, 580000, 640000, 720000, 800000, 880000, 960000, 1040000, 1120000, 1200000, 1280000, 10190000, 1400000],
    ['Enterprise Licenses', 680000, 720000, 780000, 850000, 920000, 980000, 1050000, 1120000, 1180000, 1250000, 1320000, 1400000, 12250000, 1500000],
    ['Platform Usage Fees', 280000, 295000, 315000, 335000, 355000, 375000, 395000, 415000, 435000, 455000, 475000, 495000, 4825000, 520000],
    ['API Credits & Overages', 120000, 135000, 145000, 160000, 175000, 190000, 205000, 220000, 235000, 250000, 265000, 280000, 2380000, 300000],
    ['Premium Support Plans', 95000, 98000, 102000, 105000, 108000, 112000, 115000, 118000, 122000, 125000, 128000, 132000, 1360000, 140000],
    ['Training & Certification', 65000, 72000, 78000, 85000, 92000, 98000, 105000, 112000, 118000, 125000, 132000, 138000, 1220000, 150000],
    ['Total Subscription Revenue', 3540000, 3760000, 4010000, 4255000, 4530000, 4805000, 5090000, 5365000, 5640000, 5925000, 6200000, 6495000, 59615000, 7110000],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    ['PROFESSIONAL SERVICES', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Implementation Services', 420000, 450000, 485000, 520000, 555000, 590000, 625000, 660000, 695000, 730000, 765000, 800000, 7295000, 850000],
    ['Custom Development', 280000, 320000, 360000, 400000, 440000, 480000, 520000, 560000, 600000, 640000, 680000, 720000, 6000000, 750000],
    ['Data Migration', 150000, 165000, 180000, 195000, 210000, 225000, 240000, 255000, 270000, 285000, 300000, 315000, 2790000, 330000],
    ['Integration Services', 185000, 195000, 205000, 215000, 225000, 235000, 245000, 255000, 265000, 275000, 285000, 295000, 2880000, 310000],
    ['Managed Services', 320000, 340000, 360000, 380000, 400000, 420000, 440000, 460000, 480000, 500000, 520000, 540000, 5160000, 560000],
    ['Total Professional Services', 1355000, 1470000, 1590000, 1710000, 1830000, 1950000, 2070000, 2190000, 2310000, 2430000, 2550000, 2670000, 24125000, 2800000],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    ['PARTNER & MARKETPLACE', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Partner Channel Revenue', 125000, 140000, 155000, 170000, 185000, 200000, 215000, 230000, 245000, 260000, 275000, 290000, 2490000, 320000],
    ['Marketplace Commissions', 85000, 92000, 98000, 105000, 112000, 118000, 125000, 132000, 138000, 145000, 152000, 158000, 1460000, 170000],
    ['Referral Bonuses', 45000, 48000, 52000, 55000, 58000, 62000, 65000, 68000, 72000, 75000, 78000, 82000, 760000, 90000],
    ['White Label Solutions', 180000, 195000, 210000, 225000, 240000, 255000, 270000, 285000, 300000, 315000, 330000, 345000, 3150000, 360000],
    ['Total Partner Revenue', 435000, 475000, 515000, 555000, 595000, 635000, 675000, 715000, 755000, 795000, 835000, 875000, 7860000, 940000],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    ['TOTAL REVENUE INFLOWS', 5330000, 5705000, 6115000, 6520000, 6955000, 7390000, 7835000, 8270000, 8705000, 9150000, 9585000, 10040000, 91600000, 10850000],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    // OPERATING EXPENSES
    ['OPERATING EXPENDITURES', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    ['PERSONNEL EXPENSES', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Engineering Team', -980000, -1020000, -1060000, -1100000, -1140000, -1180000, -1220000, -1260000, -1300000, -1340000, -1380000, -1420000, -14400000, -1500000],
    ['Product Management', -285000, -295000, -305000, -315000, -325000, -335000, -345000, -355000, -365000, -375000, -385000, -395000, -4040000, -420000],
    ['Sales Team', -520000, -550000, -580000, -610000, -640000, -670000, -700000, -730000, -760000, -790000, -820000, -850000, -8220000, -900000],
    ['Marketing Team', -385000, -405000, -425000, -445000, -465000, -485000, -505000, -525000, -545000, -565000, -585000, -605000, -5940000, -650000],
    ['Customer Success', -280000, -290000, -300000, -310000, -320000, -330000, -340000, -350000, -360000, -370000, -380000, -390000, -3920000, -420000],
    ['Operations & IT', -195000, -205000, -215000, -225000, -235000, -245000, -255000, -265000, -275000, -285000, -295000, -305000, -3000000, -320000],
    ['Finance & Admin', -165000, -170000, -175000, -180000, -185000, -190000, -195000, -200000, -205000, -210000, -215000, -220000, -2310000, -240000],
    ['Executive Team', -120000, -120000, -125000, -125000, -130000, -130000, -135000, -135000, -140000, -140000, -145000, -145000, -1590000, -150000],
    ['Benefits & Insurance', -285000, -295000, -305000, -315000, -325000, -335000, -345000, -355000, -365000, -375000, -385000, -395000, -4040000, -420000],
    ['Equity Compensation', -95000, -98000, -102000, -105000, -108000, -112000, -115000, -118000, -122000, -125000, -128000, -132000, -1360000, -140000],
    ['Total Personnel', -3310000, -3448000, -3592000, -3730000, -3873000, -4012000, -4155000, -4293000, -4437000, -4575000, -4718000, -4857000, -49000000, -5210000],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    ['INFRASTRUCTURE & TECHNOLOGY', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Cloud Infrastructure (AWS)', -285000, -310000, -335000, -360000, -385000, -410000, -435000, -460000, -485000, -510000, -535000, -560000, -5070000, -600000],
    ['SaaS Tools & Licenses', -125000, -130000, -135000, -140000, -145000, -150000, -155000, -160000, -165000, -170000, -175000, -180000, -1830000, -190000],
    ['Security & Compliance', -85000, -88000, -92000, -95000, -98000, -102000, -105000, -108000, -112000, -115000, -118000, -122000, -1240000, -130000],
    ['Data Storage & Backup', -45000, -48000, -52000, -55000, -58000, -62000, -65000, -68000, -72000, -75000, -78000, -82000, -760000, -90000],
    ['Monitoring & Analytics', -32000, -35000, -38000, -41000, -44000, -47000, -50000, -53000, -56000, -59000, -62000, -65000, -582000, -70000],
    ['Development Tools', -65000, -68000, -72000, -75000, -78000, -82000, -85000, -88000, -92000, -95000, -98000, -102000, -1000000, -110000],
    ['Total Infrastructure', -637000, -679000, -724000, -766000, -808000, -853000, -895000, -937000, -982000, -1024000, -1066000, -1111000, -10482000, -1190000],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    ['SALES & MARKETING', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Digital Advertising', -195000, -220000, -245000, -270000, -295000, -320000, -345000, -370000, -395000, -420000, -445000, -470000, -3990000, -520000],
    ['Content Marketing', -85000, -90000, -95000, -100000, -105000, -110000, -115000, -120000, -125000, -130000, -135000, -140000, -1350000, -150000],
    ['Events & Conferences', -125000, -140000, -155000, -170000, -185000, -200000, -215000, -230000, -245000, -260000, -275000, -290000, -2490000, -320000],
    ['Sales Tools & CRM', -45000, -48000, -52000, -55000, -58000, -62000, -65000, -68000, -72000, -75000, -78000, -82000, -760000, -90000],
    ['Lead Generation', -75000, -82000, -88000, -95000, -102000, -108000, -115000, -122000, -128000, -135000, -142000, -148000, -1340000, -160000],
    ['Partner Programs', -55000, -58000, -62000, -65000, -68000, -72000, -75000, -78000, -82000, -85000, -88000, -92000, -880000, -100000],
    ['Brand & PR', -35000, -38000, -42000, -45000, -48000, -52000, -55000, -58000, -62000, -65000, -68000, -72000, -640000, -80000],
    ['Sales Commissions', -265000, -285000, -306000, -326000, -348000, -369000, -392000, -413000, -435000, -457000, -479000, -502000, -4577000, -540000],
    ['Total Sales & Marketing', -880000, -961000, -1045000, -1126000, -1209000, -1293000, -1377000, -1459000, -1544000, -1627000, -1715000, -1796000, -16032000, -1960000],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    ['GENERAL & ADMINISTRATIVE', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Office Rent & Facilities', -75000, -78000, -82000, -85000, -88000, -92000, -95000, -98000, -102000, -105000, -108000, -112000, -1120000, -120000],
    ['Legal & Professional', -45000, -52000, -58000, -65000, -72000, -78000, -85000, -92000, -98000, -105000, -112000, -118000, -980000, -130000],
    ['Accounting & Finance', -35000, -38000, -42000, -45000, -48000, -52000, -55000, -58000, -62000, -65000, -68000, -72000, -640000, -80000],
    ['Insurance & Risk', -28000, -28000, -30000, -30000, -32000, -32000, -35000, -35000, -38000, -38000, -42000, -42000, -410000, -45000],
    ['Recruitment & HR', -55000, -62000, -68000, -75000, -82000, -88000, -95000, -102000, -108000, -115000, -122000, -128000, -1100000, -140000],
    ['Office Supplies & Misc', -18000, -20000, -22000, -24000, -26000, -28000, -30000, -32000, -34000, -36000, -38000, -40000, -348000, -45000],
    ['Total G&A', -256000, -278000, -302000, -324000, -348000, -370000, -395000, -417000, -442000, -464000, -490000, -512000, -4598000, -560000],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    ['TOTAL OPERATING EXPENSES', -5083000, -5366000, -5663000, -5946000, -6238000, -6528000, -6822000, -7106000, -7405000, -7690000, -7989000, -8276000, -80112000, -8920000],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    // NET OPERATING CASH FLOW
    ['NET OPERATING CASH FLOW', 247000, 339000, 452000, 574000, 717000, 862000, 1013000, 1164000, 1300000, 1460000, 1596000, 1764000, 11488000, 1930000],
    ['Operating Margin %', 4.6, 5.9, 7.4, 8.8, 10.3, 11.7, 12.9, 14.1, 14.9, 16.0, 16.6, 17.6, 12.5, 17.8],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    // INVESTMENT ACTIVITIES
    ['CAPITAL INVESTMENTS', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Product Development', -185000, -195000, -205000, -215000, -225000, -235000, -245000, -255000, -265000, -275000, -285000, -295000, -2880000, -320000],
    ['Technology Infrastructure', -125000, -140000, -155000, -170000, -185000, -200000, -215000, -230000, -245000, -260000, -275000, -290000, -2490000, -320000],
    ['Office Expansion', 0, -450000, 0, 0, -280000, 0, 0, -320000, 0, 0, -520000, 0, -1570000, 0],
    ['Equipment & Hardware', -35000, -42000, -48000, -55000, -62000, -68000, -75000, -82000, -88000, -95000, -102000, -108000, -860000, -120000],
    ['Acquisitions', 0, 0, -2500000, 0, 0, 0, 0, -1800000, 0, 0, 0, -3200000, -7500000, 0],
    ['IP & Patents', -25000, -28000, -32000, -35000, -38000, -42000, -45000, -48000, -52000, -55000, -58000, -62000, -520000, -70000],
    ['Total Investment', -370000, -855000, -2940000, -475000, -790000, -545000, -580000, -2735000, -650000, -685000, -1240000, -3975000, -15840000, -830000],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    // FINANCING ACTIVITIES
    ['FINANCING ACTIVITIES', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Series B Funding', 0, 0, 15000000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 15000000, 0],
    ['Venture Debt', 0, 0, 0, 2000000, 0, 0, 0, 0, 0, 0, 0, 0, 2000000, 0],
    ['Credit Facility Usage', 500000, -250000, 750000, -400000, 600000, -350000, 450000, -200000, 300000, -180000, 280000, -150000, 1350000, 0],
    ['Debt Service', -45000, -48000, -52000, -55000, -58000, -62000, -65000, -68000, -72000, -75000, -78000, -82000, -760000, -90000],
    ['Interest Payments', -25000, -28000, -32000, -35000, -38000, -42000, -45000, -48000, -52000, -55000, -58000, -62000, -520000, -70000],
    ['Working Capital Facility', 0, 0, 0, 0, 1000000, 0, 0, 0, 0, 0, 0, 0, 1000000, 0],
    ['Equipment Financing', 0, 85000, 0, 120000, 0, 95000, 0, 110000, 0, 88000, 0, 102000, 600000, 0],
    ['Total Financing', 430000, -241000, 15666000, 1630000, 1504000, -359000, 340000, -206000, 176000, -222000, 144000, -192000, 17070000, -160000],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    // FINAL CASH POSITION
    ['CASH FLOW SUMMARY', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Beginning Cash Balance', 8500000, 8807000, 8850000, 21628000, 23357000, 24791000, 24749000, 25522000, 23745000, 24571000, 25124000, 25624000, 8500000, 26596000],
    ['Operating Cash Flow', 247000, 339000, 452000, 574000, 717000, 862000, 1013000, 1164000, 1300000, 1460000, 1596000, 1764000, 11488000, 1930000],
    ['Investment Cash Flow', -370000, -855000, -2940000, -475000, -790000, -545000, -580000, -2735000, -650000, -685000, -1240000, -3975000, -15840000, -830000],
    ['Financing Cash Flow', 430000, -241000, 15666000, 1630000, 1504000, -359000, 340000, -206000, 176000, -222000, 144000, -192000, 17070000, -160000],
    ['Ending Cash Balance', 8807000, 8050000, 22028000, 23357000, 24788000, 24749000, 25522000, 23745000, 24571000, 25124000, 25624000, 23221000, 23221000, 26536000],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    // SAAS METRICS
    ['KEY SAAS METRICS', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Monthly Recurring Revenue', 1850000, 1920000, 2010000, 2080000, 2160000, 2250000, 2340000, 2420000, 2510000, 2600000, 2680000, 2770000, 2770000, 3100000],
    ['Annual Contract Value', 22200000, 23040000, 24120000, 24960000, 25920000, 27000000, 28080000, 29040000, 30120000, 31200000, 32160000, 33240000, 33240000, 37200000],
    ['Customer Acquisition Cost', 850, 920, 980, 1050, 1120, 1180, 1250, 1320, 1380, 1450, 1520, 1580, 1250, 1650],
    ['Customer Lifetime Value', 28500, 30200, 32100, 33800, 35600, 37400, 39200, 40900, 42700, 44500, 46200, 48000, 40700, 52000],
    ['LTV/CAC Ratio', 33.5, 32.8, 32.8, 32.2, 31.8, 31.7, 31.4, 31.0, 30.9, 30.7, 30.4, 30.4, 32.6, 31.5],
    ['Churn Rate %', 2.1, 1.9, 1.8, 1.7, 1.6, 1.5, 1.4, 1.4, 1.3, 1.2, 1.2, 1.1, 1.5, 1.0],
    ['Net Revenue Retention', 108, 112, 115, 118, 121, 124, 127, 130, 133, 136, 139, 142, 125, 145],
    ['Gross Revenue Retention', 97.9, 98.1, 98.2, 98.3, 98.4, 98.5, 98.6, 98.6, 98.7, 98.8, 98.8, 98.9, 98.4, 99.0],
    ['Magic Number', 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 1.7, 2.5],
    ['', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    
    // OPERATIONAL METRICS
    ['OPERATIONAL METRICS', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
    ['Total Customers', 2850, 2980, 3120, 3280, 3450, 3630, 3820, 4020, 4230, 4450, 4680, 4920, 4920, 5500],
    ['Active Users (MAU)', 18500, 19200, 20100, 21000, 21900, 22800, 23700, 24600, 25500, 26400, 27300, 28200, 28200, 32000],
    ['Employee Count', 185, 192, 198, 205, 212, 218, 225, 232, 238, 245, 252, 258, 258, 280],
    ['Revenue per Employee', 28811, 29713, 30884, 31805, 32807, 33899, 34822, 35647, 36575, 37347, 38056, 38915, 35503, 38750],
    ['Cash Burn Multiple', 20.6, 15.8, 12.5, 10.4, 8.7, 7.6, 6.7, 6.1, 5.7, 5.3, 5.0, 4.7, 7.0, 4.6],
    ['Months of Runway', 28.5, 25.8, 9.2, 12.8, 13.8, 14.2, 15.1, 11.5, 12.8, 13.4, 13.8, 10.8, 10.8, 12.5]
  ];

  // Create workbook
  const wb = XLSX.utils.book_new();
  const ws = XLSX.utils.aoa_to_sheet(data);
  
  // Set column widths for better visibility
  ws['!cols'] = [
    {wch: 40}, // Column A (descriptions)
    {wch: 12}, {wch: 12}, {wch: 12}, {wch: 12}, // Months 1-4
    {wch: 12}, {wch: 12}, {wch: 12}, {wch: 12}, // Months 5-8
    {wch: 12}, {wch: 12}, {wch: 12}, {wch: 12}, // Months 9-12
    {wch: 15}, {wch: 15} // YTD Total and Forecast
  ];
  
  XLSX.utils.book_append_sheet(wb, ws, "CloudTech 2024");
  
  // Write file
  XLSX.writeFile(wb, 'Cashflow_2024_CloudTech.xlsx');
  console.log('Generated Cashflow_2024_CloudTech.xlsx');
}

generateCashflow2024();